---
import { useI18n } from '../i18n';
const { translate, currentLang } = useI18n(Astro);
// Primero obtenemos las tarjetas desde tu traducción
const cards: readonly string[] = translate('faqs.payments.a2.cards') as readonly string[];
---

<section id="Faqs" class="py-20 grid place-content-center">
    <div class="container mx-auto px-6">
        <!-- Page Header -->
        <div class="text-center mb-12 animate-fade-in">
            <h1 class="text-4xl sm:text-5xl lg:text-6xl font-bold text-white mb-6">
                ❓ <span class="gradient-text">{translate('faqs.title')}</span>
            </h1>
            <p class="text-xl text-gray-300 max-w-3xl mx-auto">
                {translate('faqs.subtitle')}
            </p>
        </div>

        <!-- Category Tabs -->
        <div class="flex flex-wrap justify-center gap-3 mb-8 animate-slide-up">
            <button onclick="filterFAQ('all')"
                class="category-tab active px-6 py-3 rounded-full text-white font-medium border border-white/20"
                data-category="all">
                🌟 {translate('faqs.tab.all')}
            </button>
            <button onclick="filterFAQ('general')"
                class="category-tab px-6 py-3 rounded-full text-white font-medium border border-white/20"
                data-category="general">
                📋 {translate('faqs.tab.general')}
            </button>
            <button onclick="filterFAQ('seguridad')"
                class="category-tab px-6 py-3 rounded-full text-white font-medium border border-white/20"
                data-category="seguridad">
                🔒 {translate('faqs.tab.security')}
            </button>
            <button onclick="filterFAQ('pagos')"
                class="category-tab px-6 py-3 rounded-full text-white font-medium border border-white/20"
                data-category="pagos">
                💳 {translate('faqs.tab.payments')}
            </button>
        </div>

        <!-- FAQ Container -->
        <div class="faq-card rounded-2xl m-auto max-w-3xl p-6 sm:p-8 animate-slide-up">

            <!-- Search Bar -->
            <div class="mb-8">
                <div class="relative">
                    <input type="text" id="searchFAQ" placeholder={String(translate('faqs.search.placeholder'))}
                        class="w-full px-6 py-4 bg-white/10 border border-white/20 rounded-xl text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                        oninput="searchFAQ()">
                    <div class="absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-400">
                        <span class="text-xl">🔍</span>
                    </div>
                </div>
            </div>

            <!-- FAQ Items -->
            <div id="faqContainer" class="space-y-4">

                <!-- General Questions -->
                <div class="faq-item rounded-xl overflow-hidden" data-category="general">
                    <button
                        class="faq-trigger w-full px-6 py-4 text-left flex items-center justify-between hover:bg-white/5 transition-colors"
                        onclick="toggleFAQ(this)">
                        <div class="flex items-center space-x-4">
                            <span class="text-2xl">🤔</span>
                            <span class="text-white font-semibold text-lg">{translate('faqs.general.q1')}</span>
                        </div>
                        <span class="faq-icon text-white text-xl">▼</span>
                    </button>
                    <div class="faq-content px-6">
                        <div class="text-gray-300 leading-relaxed">
                            <p class="m-4">{translate('faqs.general.a1')}</p>
                        </div>
                    </div>
                </div>

                <div class="faq-item rounded-xl overflow-hidden" data-category="general">
                    <button
                        class="faq-trigger w-full px-6 py-4 text-left flex items-center justify-between hover:bg-white/5 transition-colors"
                        onclick="toggleFAQ(this)">
                        <div class="flex items-center space-x-4">
                            <span class="text-2xl">📱</span>
                            <span class="text-white font-semibold text-lg">{translate('faqs.general.q2')}</span>
                        </div>
                        <span class="faq-icon text-white text-xl">▼</span>
                    </button>
                    <div class="faq-content px-6">
                        <div class="text-gray-300 leading-relaxed">
                            <p class="m-4">{translate('faqs.general.a2')}</p>
                        </div>
                    </div>
                </div>

                <div class="faq-item rounded-xl overflow-hidden" data-category="general">
                    <button
                        class="faq-trigger w-full px-6 py-4 text-left flex items-center justify-between hover:bg-white/5 transition-colors"
                        onclick="toggleFAQ(this)">
                        <div class="flex items-center space-x-4">
                            <span class="text-2xl">❓</span>
                            <span class="text-white font-semibold text-lg">{translate('faqs.general.q3')}</span>
                        </div>
                        <span class="faq-icon text-white text-xl">▼</span>
                    </button>
                    <div class="faq-content px-6">
                        <div class="text-gray-300 leading-relaxed">
                            <p class="m-4">{translate('faqs.general.a3')}</p>
                        </div>
                    </div>
                </div>

                
            
                <!-- Security Questions -->
                <div class="faq-item rounded-xl overflow-hidden" data-category="seguridad">
                    <button
                        class="faq-trigger w-full px-6 py-4 text-left flex items-center justify-between hover:bg-white/5 transition-colors"
                        onclick="toggleFAQ(this)">
                        <div class="flex items-center space-x-4">
                            <span class="text-2xl">🛡️</span>
                            <span class="text-white font-semibold text-lg">{translate('faqs.security.q1')}</span>
                        </div>
                        <span class="faq-icon text-white text-xl">▼</span>
                    </button>
                    <div class="faq-content px-6">
                        <div class="text-gray-300 leading-relaxed">
                            <p class="m-4">{translate('faqs.security.a1')}</p>
                        </div>
                    </div>
                </div>

                <div class="faq-item rounded-xl overflow-hidden" data-category="general">
                    <button
                        class="faq-trigger w-full px-6 py-4 text-left flex items-center justify-between hover:bg-white/5 transition-colors"
                        onclick="toggleFAQ(this)">
                        <div class="flex items-center space-x-4">
                            <span class="text-2xl">🤔</span>
                            <span class="text-white font-semibold text-lg">{translate('faqs.general.q4')}</span>
                        </div>
                        <span class="faq-icon text-white text-xl">▼</span>
                    </button>
                    <div class="faq-content px-6">
                        <div class="text-gray-300 leading-relaxed">
                            <p class="m-4">{translate('faqs.general.a4')}</p>
                        </div>
                    </div>
                </div>

                <!-- Payment Questions -->

                <div class="faq-item rounded-xl overflow-hidden" data-category="general">
                    <button
                        class="faq-trigger w-full px-6 py-4 text-left flex items-center justify-between hover:bg-white/5 transition-colors"
                        onclick="toggleFAQ(this)">
                        <div class="flex items-center space-x-4">
                            <span class="text-2xl">🤷‍♂️</span>
                            <span class="text-white font-semibold text-lg">{translate('faqs.general.q5')}</span>
                        </div>
                        <span class="faq-icon text-white text-xl">▼</span>
                    </button>
                    <div class="faq-content px-6">
                        <div class="text-gray-300 leading-relaxed">
                            <p class="m-4">{translate('faqs.general.a5')}</p>
                        </div>
                    </div>
                </div>

                <div class="faq-item rounded-xl overflow-hidden" data-category="pagos">
                    <button
                        class="faq-trigger w-full px-6 py-4 text-left flex items-center justify-between hover:bg-white/5 transition-colors"
                        onclick="toggleFAQ(this)">
                        <div class="flex items-center space-x-4">
                            <span class="text-2xl">💰</span>
                            <span class="text-white font-semibold text-lg">{translate('faqs.payments.q1')}</span>
                        </div>
                        <span class="faq-icon text-white text-xl">▼</span>
                    </button>
                    <div class="faq-content px-6">
                        <div class="text-gray-300 leading-relaxed">
                            <p class="m-4">{translate('faqs.payments.a1')}</p>
                        </div>
                    </div>
                </div>

                <div class="faq-item rounded-xl overflow-hidden" data-category="pagos">
                    <button
                        class="faq-trigger w-full px-6 py-4 text-left flex items-center justify-between hover:bg-white/5 transition-colors"
                        onclick="toggleFAQ(this)">
                        <div class="flex items-center space-x-4">
                            <span class="text-2xl">💳</span>
                            <span class="text-white font-semibold text-lg">{translate('faqs.payments.q2')}</span>
                        </div>
                        <span class="faq-icon text-white text-xl">▼</span>
                    </button>
                    <div class="faq-content px-6">
                        <div class="text-gray-300 leading-relaxed mx-4">
                            <p class="mb-4">{translate('faqs.payments.a2')}</p>
                            <div class="flex justify-center items-center gap-4">
                                <div class="bg-white/5 rounded-lg p-4">
                                    <h4 class="text-white font-semibold flex items-center">
                                        <span class="mr-2 mb-1 inline-block">💳</span>
                                        {translate('faqs.payments.a2.title')}
                                    </h4>
                                    <ul class="text-sm space-y-1">
                                        {cards.map((card) => (
                                            <li>• {card}</li>
                                        ))}
                                    </ul>
                                </div>

                            </div>
                            <div class="mt-4 p-3 bg-blue-500/20 rounded-lg">
                                <p class="text-blue-200 text-sm">🔒 {translate('faqs.payments.a2.note')}</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Additional Questions -->
                <div class="faq-item rounded-xl overflow-hidden" data-category="general">
                    <button
                        class="faq-trigger w-full px-6 py-4 text-left flex items-center justify-between hover:bg-white/5 transition-colors"
                        onclick="toggleFAQ(this)">
                        <div class="flex items-center space-x-4">
                            <span class="text-2xl">💬</span>
                            <span class="text-white font-semibold text-lg">{translate('faqs.general.q6')}</span>
                        </div>
                        <span class="faq-icon text-white text-xl">▼</span>
                    </button>
                    <div class="faq-content px-6">
                        <div class="text-gray-300 leading-relaxed">
                            <p class="m-4">{translate('faqs.general.a6')}</p>
                        </div>
                    </div>
                </div>

                <div class="faq-item rounded-xl overflow-hidden" data-category="general">
                    <button
                        class="faq-trigger w-full px-6 py-4 text-left flex items-center justify-between hover:bg-white/5 transition-colors"
                        onclick="toggleFAQ(this)">
                        <div class="flex items-center space-x-4">
                            <span class="text-2xl">🔐</span>
                            <span class="text-white font-semibold text-lg">{translate('faqs.general.q7')}</span>
                        </div>
                        <span class="faq-icon text-white text-xl">▼</span>
                    </button>
                    <div class="faq-content px-6">
                        <div class="text-gray-300 leading-relaxed">
                            <p class="m-4">{translate('faqs.general.q7')}</p>
                        </div>
                    </div>
                </div>

            </div>

            <!-- No Results Message -->
            <div id="noResults" class="hidden text-center py-12">
                <div class="text-6xl mb-4">🔍</div>
                <h3 class="text-2xl font-bold text-white mb-2">No se encontraron resultados</h3>
                <p class="text-gray-300 mb-6">Intenta con otros términos de búsqueda o contacta con nuestro soporte</p>
                <button onclick="clearSearch()"
                    class="px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-500 text-white font-semibold rounded-lg hover:scale-105 transform transition-all duration-300">
                    Limpiar Búsqueda
                </button>
            </div>

        </div>
    </div>
</section>


<script is:inline>
        // Toggle FAQ item
        function toggleFAQ(trigger) {
            const faqItem = trigger.closest('.faq-item');
            const content = faqItem.querySelector('.faq-content');
            const isActive = faqItem.classList.contains('active');
            
            // Close all other FAQ items
            document.querySelectorAll('.faq-item.active').forEach(item => {
                if (item !== faqItem) {
                    item.classList.remove('active');
                    item.querySelector('.faq-content').classList.remove('active');
                }
            });
            
            // Toggle current item
            if (isActive) {
                faqItem.classList.remove('active');
                content.classList.remove('active');
            } else {
                faqItem.classList.add('active');
                content.classList.add('active');
            }
        }

        // Filter FAQ by category
        function filterFAQ(category) {
            const faqItems = document.querySelectorAll('.faq-item');
            const tabs = document.querySelectorAll('.category-tab');
            
            // Update active tab
            tabs.forEach(tab => {
                tab.classList.remove('active');
                if (tab.dataset.category === category) {
                    tab.classList.add('active');
                }
            });
            
            // Show/hide FAQ items
            faqItems.forEach(item => {
                if (category === 'all' || item.dataset.category === category) {
                    item.style.display = 'block';
                    setTimeout(() => {
                        item.style.opacity = '1';
                        item.style.transform = 'translateY(0)';
                    }, 100);
                } else {
                    item.style.opacity = '0';
                    item.style.transform = 'translateY(-20px)';
                    setTimeout(() => {
                        item.style.display = 'none';
                    }, 300);
                }
            });
            
            // Close all open items when filtering
            document.querySelectorAll('.faq-item.active').forEach(item => {
                item.classList.remove('active');
                item.querySelector('.faq-content').classList.remove('active');
            });
        }

        // Search FAQ
        function searchFAQ() {
            const searchTerm = document.getElementById('searchFAQ').value.toLowerCase();
            const faqItems = document.querySelectorAll('.faq-item');
            const noResults = document.getElementById('noResults');
            let hasResults = false;
            
            faqItems.forEach(item => {
                const question = item.querySelector('.faq-trigger span:nth-child(2)').textContent.toLowerCase();
                const answer = item.querySelector('.faq-content').textContent.toLowerCase();
                
                if (question.includes(searchTerm) || answer.includes(searchTerm)) {
                    item.style.display = 'block';
                    item.style.opacity = '1';
                    item.style.transform = 'translateY(0)';
                    hasResults = true;
                } else {
                    item.style.opacity = '0';
                    item.style.transform = 'translateY(-20px)';
                    setTimeout(() => {
                        item.style.display = 'none';
                    }, 300);
                }
            });
            
            // Show/hide no results message
            if (hasResults || searchTerm === '') {
                noResults.classList.add('hidden');
            } else {
                noResults.classList.remove('hidden');
            }
            
            // Reset category filter when searching
            if (searchTerm !== '') {
                document.querySelectorAll('.category-tab').forEach(tab => {
                    tab.classList.remove('active');
                });
            }
        }

        // Clear search
        function clearSearch() {
            document.getElementById('searchFAQ').value = '';
            document.getElementById('noResults').classList.add('hidden');
            filterFAQ('all');
        }


        function openChat() {
            alert('Abriendo chat de soporte...');
            // Aquí se integraría el sistema de chat real
        }

        // Initialize animations on load
        document.addEventListener('DOMContentLoaded', function() {
            // Intersection Observer for scroll animations
            const observerOptions = {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            };

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateY(0)';
                    }
                });
            }, observerOptions);

            // Observe all animated elements
            document.querySelectorAll('.animate-slide-up').forEach(el => {
                el.style.opacity = '0';
                el.style.transform = 'translateY(30px)';
                el.style.transition = 'all 0.6s ease-out';
                observer.observe(el);
            });

            // Initialize FAQ items with smooth transitions
            document.querySelectorAll('.faq-item').forEach(item => {
                item.style.transition = 'all 0.3s ease';
            });
        });

        // Keyboard navigation
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                // Close all open FAQ items
                document.querySelectorAll('.faq-item.active').forEach(item => {
                    item.classList.remove('active');
                    item.querySelector('.faq-content').classList.remove('active');
                });
            }
        });
    </script>